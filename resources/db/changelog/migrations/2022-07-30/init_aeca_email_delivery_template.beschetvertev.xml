<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.9.xsd">
    <changeSet id="init_aeca_email_delivery_template.beschetvertev.xml" author="pavel.beschetvertev">
        <comment>Создание таблицы шаблонов рассылки</comment>
        <createTable tableName="aeca_email_delivery_template"
                     remarks="Шаблоны рассылки">
            <column name="id"
                    type="bigint"
                    remarks="Идентификатор записи"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="aeca_email_delivery_template_id_pkey"
                             nullable="false"
                             unique="true"/>
            </column>

            <column name="template_name"
                    type="text"
                    remarks="Название шаблона">
                <constraints nullable="false"/>
            </column>
            <column name="subject"
                    type="text"
                    remarks="Тема письма">
                <constraints nullable="false"/>
            </column>

            <column name="interval"
                    type="bigint"
                    remarks="Время в мс до события">
                <constraints nullable="false"/>
            </column>

            <column name="status"
                    type="text"
                    remarks="Статус">
                <constraints nullable="false"/>
            </column>

            <column name="created"
                    type="datetime"
                    defaultValueComputed="now()"
                    remarks="Дата и время создания">
                <constraints nullable="false"/>
            </column>
            <column name="updated"
                    type="datetime"
                    remarks="Дата и время обновления">
                <constraints nullable="true"/>
            </column>

            <column name="delivery_type_id"
                    type="bigint"
                    remarks="Ссылка на тип рассылки">
                <constraints nullable="false"
                             foreignKeyName="aeca_email_delivery_type_dict_delivery_type_id_fkey"
                             referencedTableName="aeca_email_delivery_type_dict"
                             referencedColumnNames="id"
                             deleteCascade="true"/>
            </column>
        </createTable>

        <sql endDelimiter=";">
            INSERT INTO public.aeca_email_delivery_template (template_name,subject,"interval",delivery_type_id,"status") VALUES
            ('Рассылка об истечении срока действия сертификата через 30 дней','Срок действия Вашего сертификата истекает через 30 дней.',2592000000,1,'ACTIVE'),
            ('Рассылка об истечении срока действия сертификата через 7 дней','Срок действия Вашего сертификата истекает через 7 дней.',604800000,1,'ACTIVE'),
            ('Рассылка об истечении срока действия сертификата через 1 день','Срок действия Вашего сертификата истекает через 1 день.',86400000,1,'ACTIVE');
        </sql>
    </changeSet>
</databaseChangeLog>